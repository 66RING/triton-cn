## 背景简介


在过去的十年中，深度神经网络 (DNNs) 作为一种重要的机器学习模型，已经成为一项在许多领域都能实现最先进性能的关键技术，涵盖自然语言处理[「SUTSKEVER2014」](#参考文献)、计算机视觉 [「REDMON2016」](#参考文献)和计算神经科学[「LEE2017」](#参考文献)等。这些模型的强大之处在于它们的分层结构，由一系列参数化（例如卷积）和非参数化（例如修正线性）的*层*组成。尽管这种模式因计算成本昂贵而闻名，但也生成了大量高度可并行化的工作，特别适合 multi-core 和 many-core 处理器。


因此，图形处理单元 (GPUs) 已经成为探索和/或部署领域内新研究思路的廉价和可访问资源。CUDA 和 OpenCL 等几个通用 GPU 计算框架的发布进一步推动了这一趋势，使得开发高性能程序变得更加容易。然而，对于不能有效地使用预先存在的优化基元组合实现的计算任务，GPU 仍然极具挑战性，特别是在优化数据局部性和并行性方面。更糟糕的是，GPU 架构也在迅速演进和专业化，如 NVIDIA（以及最近的 AMD ）微架构中张量内核心增加。


DNNs 提供的计算机会 (computational opportunities) 与 GPU 编程的实际困难之间的矛盾，使得学术界和工业界对领域特定语言 (DSLs) 和编译器产生了极大兴趣。遗憾的是，这些系统无论是基于多面体机制（例如 Tiramisu [[BAGHDADI2021]](#参考文献)、Tensor Comprehensions [[VASILACHE2018]](#参考文献)）还是调度语言（例如 Halide [[JRK2013]](#参考文献)、TVM [[CHEN2018]](#参考文献)），其在相同算法下的灵活性和性能上仍然不及最佳手写计算内核，如 [[cuBLAS](https://docs.nvidia.com/cuda/cublas/index.html)]([https://docs.nvidia.com/cuda/cublas/index.htm](https://docs.nvidia.com/cuda/cublas/index.html)l)、[cuDNN](https://docs.nvidia.com/deeplearning/cudnn/api/index.html)或 [TensorRT](https://docs.nvidia.com/deeplearning/tensorrt/developer-guide/index.html)。


本项目的主要假设是：基于阻塞算法 [[LAM1991]](#参考文献) 的编程范式可以促进神经网络的高性能计算内核的构建。我们特别重新审视传统的「单程序多数据」(SPMD [[AUGUIN1983]](#参考文献)) 执行模型在 GPU 上的应用，并提出一种变体，其中程序而非线程 (threads) 将被分块。例如，在矩阵乘法中，CUDA 和 Triton 的区别如下：


CUDA 编程模型（标量程序，阻塞线程)

```plain
#pragma parallel
for(int m = 0; m < M; m++) {
    #pragma parallel
    for(int n = 0; n < N; n++) {
        float acc = 0;
        for(int k = 0; k < K; k++)
            acc += A[m, k] * B[k, n];
        C[m, n] = acc;
    }
}
```
![图片](data:image/png;base64,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)

Triton 编程模型 (Blocked Program, Scalar Threads)


```plain
// Triton Programming Model
#pragma parallel
for(int m = 0; m < M; m += MB) {
    #pragma parallel
    for(int n = 0; n < N; n += NB) {
        float acc[MB, NB] = 0;
        for(int k = 0; k < K; k += KB)
            acc += A[m:m+MB, k:k+KB] @ B[k:k+KB, n:n+NB];
        C[m:m+MB, n:n+NB] = acc;
    }
}


```
![图片](data:image/png;base64,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)

这种方法的关键优势在于它产生了块结构化的迭代空间，为程序员在实现稀疏操作时提供了比现有 DSL 更多的灵活性，同时允许编译器针对数据局部性和并行性进行积极优化。


## 挑战


我们提出的编程范式面临的主要挑战是工作调度，即如何有效地在现代 GPU 上执行每个程序实例的工作分配。为了解决这个问题，Triton 编译器大量使用*块级数据流分析*，这是一种基于目标程序的控制流和数据流结构静态调度迭代块的技术。结果显示，该系统实际上效果非常好：我们的编译器能够自动应用广泛的有趣优化（例如自动合并、线程调度、预取、自动矢量化、张量核心感知的指令选择、共享内存分配/同步、异步复制调度）。当然，要做到这一切并不简单；本指南的一个目的就是让您了解它的工作原理。


## 参考文献


* [[SUTSKEVER2014]](#背景简介) I. Sutskever 等人，“使用神经网络的序列到序列学习”，NIPS 2014
* [[REDMON2016]](#背景简介) J. Redmon 等人，“You Only Look Once: 统一的实时对象检测”，CVPR 2016
* [[LEE2017]](#背景简介) K. Lee 等人，“SNEMI3D 连接组挑战的超人精度”，ArXiV 2017
* [[BAGHDADI2021]](#背景简介) R. Baghdadi 等人，“Tiramisu: 用于表达快速和可移植代码的多面体编译器”，CGO 2021
* [[VASILACHE2018]](#背景简介) N. Vasilache 等人，“Tensor Comprehensions: 与框架无关的高性能机器学习抽象”，ArXiV 2018
* [[JRK2013]](#背景简介) J. Ragan-Kelley 等人，“Halide: 用于优化并行性、局部性和重计算的语言和编译器”，PLDI 2013
* [[CHEN2018]](#背景简介) T. Chen 等人，“TVM: 用于深度学习的自动化端到端优化编译器”，OSDI 2018
* [[LAM1991]](#背景简介) M. Lam 等人，“阻塞算法的缓存性能和优化”，ASPLOS 1991
* [[AUGUIN1983]](#背景简介) M. Auguin 等人，“Opsila: 用于数值分析和信号处理的先进 SIMD”，EUROMICRO 1983

